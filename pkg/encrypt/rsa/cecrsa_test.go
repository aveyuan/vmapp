package rsa

import (
	"log"
	"testing"
)

func TestRsa(t *testing.T) {
	// PKCS1
	pub := "MIIBCgKCAQEAxgMxbx9aCniuX1qUiOyGHWwZEUH5WOR0OcB/HVoO0CQYGGxPk8S88qgX8syO3g3KcM7LlOjriT6Pkhj4x101x1uVIhgOvDBjeHFiN1Lj2j5CURtlr4qbvY1P5LjteQM4Rn7xd1UC9u1TP6OwGpqcdgrXivDDSEuu0/G7snq9w7X8Ukk14WJOiYr2otVocBzH7HfOtrEHYc2Ek7ZDSBPP7tTRBdOf5Fn6VHGLVoHit2BJ0UIHG59WuZr+zw2HluWfRpEkDHvsnIsqPDSbhqCBejp0XpFXWV2rFpjJZ3p8ms+R/2CJNQBZt731TilxABh6qri1WaEhdRmpxuLls0jBhQIDAQAB"
	prive := "MIIEpAIBAAKCAQEAxgMxbx9aCniuX1qUiOyGHWwZEUH5WOR0OcB/HVoO0CQYGGxPk8S88qgX8syO3g3KcM7LlOjriT6Pkhj4x101x1uVIhgOvDBjeHFiN1Lj2j5CURtlr4qbvY1P5LjteQM4Rn7xd1UC9u1TP6OwGpqcdgrXivDDSEuu0/G7snq9w7X8Ukk14WJOiYr2otVocBzH7HfOtrEHYc2Ek7ZDSBPP7tTRBdOf5Fn6VHGLVoHit2BJ0UIHG59WuZr+zw2HluWfRpEkDHvsnIsqPDSbhqCBejp0XpFXWV2rFpjJZ3p8ms+R/2CJNQBZt731TilxABh6qri1WaEhdRmpxuLls0jBhQIDAQABAoIBAQC4EyfVYZPWwDF5uz7xus9Ccscq3+Xo2ReiyGxi4OF8ZNFxgt7HQ9FS0yjQMZFuo+tZyyQ+Hfk38MyOyGAdFW11EpIky7CHCYSu5tijDY97xvznYUy6T2RQZhmrSq6YHIIoJsJaaNEEs8L8GjMPyENDCPku1Hr1rkWsCcCvPqNCVzzHI2YRPPd+evbpD3Q2OLLLrbzHvNyIvHpEDVPcxy47b188mlovfukN7dViwMSFymHacVN7UISeC/tahEsS76JRrqW5QDNrRDsFSa9FOy4kBiXrhWgmBz3O6Z+V3iKf/DUUXGaitLmmPpTL1CSxNjr/yw+X6sfC02gMVCNP/IUBAoGBAOLmag/kaTI1TdUGF5myr3ZipTRWCpWVe6IHCQQGypqwOTe3avl1gkdgXiNXNaAqDgJC7hRJvdIU97DXebspTgLLUbvZSmmdVd96IIg+dphsXcsP3h25zBY8dglg1g8gMBchaupH9haP49Lgraf54Qrc4PQZP9+vtHB9xttC5U/VAoGBAN9oV16lCeG9QrSlo8AGq/T+LlaV21q7J6JgANUwVLVtRsIu2pQjZ4nBAGH19eM5XvRAvxcfP1KppOU6Hvo7j44Wockl358EjfXjlxtWX3Ior6ABdEOtQLg9hdarEOc+Jz/EsOolC+QlNlijvDlpmxKYntzr5NApBNXrOGFaDTLxAoGAK9vWDJReMTJUhSTUUwVTHVMcE+29xgRLDZrGh1y4tQXzSW3O48FvGVTrXXFyEC+Q3acKVima44ziA/DiuubVCX07o0/xLlEXVEdLGorYacYoqyO6D4zmgjXVqyJoviu+n/n5rKeUTfAqXYzIhHusoGjposVur1JLUqM9WQypPrECgYEAvrrm9H90G0woOe+8CEHp5sRmrTdNSX3EzaSmsVuMxkOgCEJWC+jaCUpD2F5TaYVeYqswOT5NInaAt87SCZJ18bmyr/bsnmcWB5ohNI6d9+lyXuk+6FRuj5y+udHcIX/3pEJ5Q70TFNkMN8q59E4LvWmdH0EpXOnYHgWuYbau1BECgYApFADg4y9EyzIBr7nasdkewNYmpWpztGEfzxU+SAqpmibA1CcJBed0XJ0WBUbleMGiMKyas0r2FXd7ddRxKrgGAghrrD8yIurm482UoZwShbDQQqQRGpYkB57sWdq1iZQhsz9gaw0dTGrAB1PZ8k6hlRCRhUFTwFfv73pLXw0k4A=="
	rsa, err := NewCecRSA(pub, prive, WithPcks(Pcks1))
	if err != nil {
		t.Fatal(err)
	}
	enc, err := rsa.Encrypt("123456")
	if err != nil {
		t.Fatal(err)
	}
	log.Print(enc)
	// enc := "NUlfW/uBTenaj4eV56qJt3erAmN9vlmwtVJdBe7MffL13AhQraotoabTdP3AyLYv17u3cXlq99LhVCd8XtKYSI+2ckXiE36VHbsxWNGTC3N/899aXZu9wNR9HneIH12KrxmNv0qajEYvqtzNVs683fEW+NjtXU+M19tZvJP2lVVqz5vuFNyj/b3cjf/AFzKMn8aCw1p/H5Cf8yc25ysLBpS/+L7bU15Geb5OQqNqI8kyHelxX87BxI32GcU5+B3NiYd1WTuJlIZylGnOvOW+O1KGFfMW5E+qmYpSh2ZVQEJU1P2inqS/tOrgUHlCULIZYzV3U+kU7Nrmv0NOpOOw+g=="
	dec, err := rsa.Decrypt(enc)
	if err != nil {
		t.Fatal(err)
	}
	log.Print(dec)

	// PKCS8
	pub = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2eaCfKcK0pGtzra0vqRON3Mo49DiNHtIMzFm8kMHn2my1Q2t65xWt2BOAORJpz2/VRW8hV7lLZAUKzMBxW1IV0mwam7c7JAGBOY/8APRR1eTbFUN616xgHF+TyQ0JV3Oxmak7czDDpmzQfAq1+/kVawXcBhzdNfnBI6OapM92P0XMYQsSEWCASNiNkX69YEjsMQT25vB17T+Da0JrLSNohaOwikAcsehjC5Ubg8TvzZxB9hYEaGs+wKSBEbNk9w4ngnungHwlCdjAkyUmiAnPCM05cKzyk7NE9GzW8WB4GYahI/yy8Y7/sOYKnF51UyUlMq/bTNd+BQE3cSS0YTQXwIDAQAB"
	prive = "MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDZ5oJ8pwrSka3OtrS+pE43cyjj0OI0e0gzMWbyQwefabLVDa3rnFa3YE4A5EmnPb9VFbyFXuUtkBQrMwHFbUhXSbBqbtzskAYE5j/wA9FHV5NsVQ3rXrGAcX5PJDQlXc7GZqTtzMMOmbNB8CrX7+RVrBdwGHN01+cEjo5qkz3Y/RcxhCxIRYIBI2I2Rfr1gSOwxBPbm8HXtP4NrQmstI2iFo7CKQByx6GMLlRuDxO/NnEH2FgRoaz7ApIERs2T3DieCe6eAfCUJ2MCTJSaICc8IzTlwrPKTs0T0bNbxYHgZhqEj/LLxjv+w5gqcXnVTJSUyr9tM134FATdxJLRhNBfAgMBAAECggEBAKc8hmubXPANxQMBMSmcOzfNl9V5jRNQhzJbOTK4hVIxMoLYU+KgA+IL9PI0Q98qwf1QiHcoROa6TPB23mYjIMF1mgOmAMNDKot6GBpjI60IpuofQWajL8Jv2Mxu8eK346pcPzsPy6kaB/2UkZ1Xzbx/LyHmcj58Mh9KNj3PskklUwHL5F1Q02np4PLo70oRqPsiPndcXChREIdMZNe9KEgLd7j5M/lBTOFCySGnPFKnR2Oyfcks1dbk6vbqErXo042vdGhYyVMXYCDUuh9nLS1LrCKN5j4C2nbm3O8kreM5fxowrFzdI0mA10T3DY3QDD2LzuW2GRDHA0M5ADgHStkCgYEA+uywZaj8fwaPHFt6uCVGQy+X0mG6CyDrCZeph+BRem4kmP6vNX1cY0965WssqXANh5oxFJ+xKiIiK/ZRAxSJdXva0uX1KeALbO0ol+3MXu8iSaUi6dVfwDWz0jZEJzz4S2HYLTIIE6YxId1xUL7heH8cp3Xpz1VlmEPZFPrXHyUCgYEA3k7RjlXtp8PVl9FuBjTz5cx8ssgwzD6ZAmZDC1+shbzI0n7o1lJC6Fpauw/5EazOAxHWlr9nk4mID08QzaClo2r4RyYygHAJrvr16VJsdr+Qu4qtWoa76wdDoS5Ktlug5YF/MtR+gwdRCsESU921GK/aVwxot3RUjXAblz2ObDMCgYAU2u1CVcw+poXofnXxri9r0B3XP4Yd/KtsTa2qfGtpOJRUHv7i/DtcibOWM9Uvc/+74IXpx+gKr3GVo9BR6DgQiq3CT5iT1Wo9sGxqTDprPYblBhOjybc+m3gJpbb+Z+PfKA+2mezv7SUyQlxzsJm+0RnJlVRMhjV+dU0qoDqW/QKBgCGuHU+MMzJMmCqlHx8vnJf/MBFCBSqcfUAA0D2D5DZq0J4bfhkiY2KidcaLd/e2j4ulgzZZj06p8oQnPWt54D5u8WiOH+6XitAI04Li6u3evgW7z+G8MfI8qoFb6xPPtAOxZ90ClpwxWpTfhXBRUaOI2PKBPcg1hq3bA0MZn19DAoGBAMHwuW+jbaoF4NstueCMJnbVKhFDemoavqKvq6g8gXD3faiZLx2cw5ApEVS9Yxs5ePWI+IQ9y5+17/DIN05jTdWyIqnQrJZQlwIwpQDXx7Y7/wfnotZjJyAE5pU99lws8nLOw8bUaivBg7wHjewFIJAsi+q9s7WAnEVS1UV+RUIw"
	rsa, err = NewCecRSA(pub, prive, WithPcks(Pcks8))
	if err != nil {
		t.Fatal(err)
	}
	enc, err = rsa.Encrypt("123456")
	if err != nil {
		t.Fatal(err)
	}
	log.Print(enc)
	dec, err = rsa.Decrypt(enc)
	if err != nil {
		t.Fatal(err)
	}
	log.Print(dec)
}
